## 日志模块设计

日志库采用的双缓冲区交互技术，基本思路是准备两块缓冲区：Buffer A 与 Buffer B。 前端负责往 Buffer A 中填写数据(日志消息) , 后端负责将 Buffer B 中的数据写入可持久化到文件中。 当 Buffer A 写满后唤醒后台线程交换 A 与 B ，让后端线程将交换后的 Buffer B 中数据写入到文件中，而前端线程可以继续往交换后的 Buffer A 中填入新的日志文件，如此反复。

用两个 Buffer 的好处是在新建日志消息的时候不必等待磁盘文件操作，也避免每条消息都触发(唤醒)后端日志线程，换言之，前端线程不是将一条条消息日志分别传送给后端，而是将多个日志消息拼成一个大的 Buffer 传送给后端，相当于批处理，减少了线程唤醒的频率，还减少了与磁盘交互的次数，降低了性能开销。 另外，为了将消息及时写入到文件中，即使前端的 Buffer A未写满，后台线程也会每三秒执行一次上述的交换进行磁盘写入操作。